<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>T√§gliche Lernaufgaben - LRS-angepasst</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen p-4">
    <div class="max-w-4xl mx-auto">
        <!-- Header -->
        <header class="bg-white rounded-lg shadow-lg p-6 mb-6">
            <h1 class="text-3xl font-bold text-gray-800 text-center">üìö T√§gliche Lernaufgabe</h1>
            <p class="text-gray-600 text-center mt-2">Schritt f√ºr Schritt zum Lernerfolg - Einfach und verst√§ndlich</p>
            <p class="text-sm text-gray-500 text-center mt-1">√úber 100 verschiedene Aufgaben verf√ºgbar!</p>
        </header>

        <!-- Hauptbereich -->
        <div class="bg-white rounded-lg shadow-lg p-6">
            <!-- Buttons zur Aufgabenauswahl -->
            <div class="flex gap-4 mb-6 flex-wrap justify-center">
                <button onclick="generiereZufaelligeAufgabe()" 
                        class="bg-gradient-to-r from-purple-500 to-pink-500 text-white px-6 py-3 rounded-lg hover:from-purple-600 hover:to-pink-600 transition-all transform hover:scale-105 shadow-lg font-semibold">
                    üé≤ Zuf√§llige Aufgabe generieren
                </button>
                <button onclick="generiereMatheAufgabe()" 
                        class="bg-gradient-to-r from-blue-500 to-cyan-500 text-white px-6 py-3 rounded-lg hover:from-blue-600 hover:to-cyan-600 transition-all transform hover:scale-105 shadow-lg font-semibold">
                    ‚ûï Mathe-Textaufgabe
                </button>
                <button onclick="generiereTextAufgabe()" 
                        class="bg-gradient-to-r from-green-500 to-teal-500 text-white px-6 py-3 rounded-lg hover:from-green-600 hover:to-teal-600 transition-all transform hover:scale-105 shadow-lg font-semibold">
                    üìñ Textverst√§ndnis
                </button>
            </div>

            <!-- Aufgabenbereich -->
            <div id="aufgabenBereich" class="hidden">
                <!-- Aufgabentyp-Anzeige -->
                <div id="aufgabenTyp" class="mb-4 p-3 rounded-lg text-center font-semibold"></div>
                
                <!-- Aufgabentext -->
                <div id="aufgabenText" class="bg-gray-50 p-6 rounded-lg mb-6 text-lg leading-relaxed"></div>
                
                <!-- Antwortbereich -->
                <div id="antwortBereich" class="space-y-4"></div>
                
                <!-- Speichern Button -->
                <div class="mt-6 flex gap-4 justify-center">
                    <button onclick="speichereAntworten()" 
                            class="bg-gradient-to-r from-green-500 to-emerald-500 text-white px-6 py-3 rounded-lg hover:from-green-600 hover:to-emerald-600 transition-all transform hover:scale-105 shadow-lg font-semibold">
                        üíæ Antworten speichern
                    </button>
                    <button onclick="zeigeGespeicherteAntworten()" 
                            class="bg-gradient-to-r from-gray-500 to-gray-600 text-white px-6 py-3 rounded-lg hover:from-gray-600 hover:to-gray-700 transition-all transform hover:scale-105 shadow-lg font-semibold">
                        üìã Gespeicherte Antworten
                    </button>
                </div>
            </div>

            <!-- Startmeldung -->
            <div id="startMeldung" class="text-center py-12 text-gray-500">
                <p class="text-xl mb-2">üëÜ Klicke oben auf einen Button</p>
                <p>um eine neue Aufgabe zu generieren!</p>
            </div>
        </div>

        <!-- Gespeicherte Antworten Modal -->
        <div id="gespeicherteAntwortenModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
            <div class="bg-white rounded-lg max-w-3xl w-full max-h-[80vh] overflow-y-auto p-6">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-2xl font-bold">üìã Gespeicherte Antworten</h2>
                    <button onclick="schliesseModal()" class="text-gray-500 hover:text-gray-700 text-2xl">‚úï</button>
                </div>
                <div id="gespeicherteAntwortenInhalt"></div>
            </div>
        </div>
    </div>

    <script>
        // Wiederholungsschutz - letzte 10 Aufgaben merken
        let letzteAufgabenIndizes = {
            mathe: [],
            text: []
        };
        const WIEDERHOLUNGSSCHUTZ_ANZAHL = 10;

        // Erweiterte Mathe-Aufgaben Datenbank (60+ Aufgaben)
        const matheAufgaben = {
            addition: [
                { text: "Tom kauft 3 √Ñpfel. Seine Mutter gibt ihm noch 5 √Ñpfel dazu. Wie viele √Ñpfel hat Tom jetzt?", operation: "3 + 5" },
                { text: "Lisa hat 12 Euro gespart. Sie bekommt 8 Euro Taschengeld. Wie viel Geld hat Lisa insgesamt?", operation: "12 + 8" },
                { text: "Im Bus sitzen 15 Personen. An der Haltestelle steigen 7 Personen ein. Wie viele Personen sind jetzt im Bus?", operation: "15 + 7" },
                { text: "Paul sammelt Karten. Er hat 24 Karten. Sein Freund schenkt ihm 16 Karten. Wie viele Karten hat Paul nun?", operation: "24 + 16" },
                { text: "In der Schale liegen 18 Kirschen. Marie legt noch 13 Kirschen dazu. Wie viele Kirschen sind es zusammen?", operation: "18 + 13" },
                { text: "Tim hat 27 Murmeln. Er findet noch 19 Murmeln. Wie viele Murmeln hat er insgesamt?", operation: "27 + 19" },
                { text: "In der Klasse sind 14 M√§dchen. Es kommen 11 Jungen dazu. Wie viele Kinder sind in der Klasse?", operation: "14 + 11" },
                { text: "Der B√§cker backt 35 Br√∂tchen. Sp√§ter backt er noch 28 Br√∂tchen. Wie viele Br√∂tchen hat er gebacken?", operation: "35 + 28" },
                { text: "Nina hat 43 Sticker. Ihre Oma schenkt ihr 37 weitere Sticker. Wie viele Sticker hat Nina jetzt?", operation: "43 + 37" },
                { text: "Im Parkhaus stehen 56 Autos. Es kommen 29 Autos dazu. Wie viele Autos stehen nun im Parkhaus?", operation: "56 + 29" },
                { text: "Leon hat 17 Fu√üballkarten. Er bekommt noch 26 Karten geschenkt. Wie viele Karten hat er insgesamt?", operation: "17 + 26" },
                { text: "In der Dose sind 38 Kekse. Mama legt noch 24 Kekse dazu. Wie viele Kekse sind in der Dose?", operation: "38 + 24" },
                { text: "Der Zug hat 67 Fahrg√§ste. Am Bahnhof steigen 45 Menschen ein. Wie viele Fahrg√§ste sind jetzt im Zug?", operation: "67 + 45" },
                { text: "Im Schwimmbad sind 48 Kinder. Es kommen noch 33 Kinder. Wie viele Kinder sind insgesamt im Schwimmbad?", operation: "48 + 33" },
                { text: "Julia hat 29 Perlen. Sie kauft noch 52 Perlen dazu. Wie viele Perlen hat Julia zusammen?", operation: "29 + 52" }
            ],
            subtraktion: [
                { text: "Emma hat 20 Bonbons. Sie verschenkt 8 Bonbons an ihre Freunde. Wie viele Bonbons hat Emma noch?", operation: "20 - 8" },
                { text: "Ein Parkplatz hat 50 Pl√§tze. 35 Autos stehen dort. Wie viele Pl√§tze sind noch frei?", operation: "50 - 35" },
                { text: "Max hat 30 Euro. Er kauft ein Buch f√ºr 12 Euro. Wie viel Geld hat Max noch √ºbrig?", operation: "30 - 12" },
                { text: "In einer Schachtel sind 45 Stifte. Die Lehrerin nimmt 18 Stifte heraus. Wie viele Stifte sind noch in der Schachtel?", operation: "45 - 18" },
                { text: "Tom hat 25 Murmeln. Er verliert 9 Murmeln. Wie viele Murmeln hat Tom noch?", operation: "25 - 9" },
                { text: "Im K√ºhlschrank sind 32 Eier. Mama braucht 14 Eier zum Backen. Wie viele Eier bleiben √ºbrig?", operation: "32 - 14" },
                { text: "Lisa hat 60 Aufkleber. Sie gibt ihrer Schwester 23 Aufkleber ab. Wie viele hat Lisa noch?", operation: "60 - 23" },
                { text: "Der Lehrer hat 48 Hefte. Er teilt 31 Hefte aus. Wie viele Hefte beh√§lt er?", operation: "48 - 31" },
                { text: "Im Korb sind 75 √Ñpfel. Die Familie isst 28 √Ñpfel. Wie viele √Ñpfel bleiben im Korb?", operation: "75 - 28" },
                { text: "Anna hat 84 Euro gespart. Sie kauft ein Spiel f√ºr 36 Euro. Wie viel Geld hat sie noch?", operation: "84 - 36" },
                { text: "Im Bus sind 53 Personen. An der Haltestelle steigen 17 Personen aus. Wie viele bleiben im Bus?", operation: "53 - 17" },
                { text: "Die B√§ckerei hat 92 Br√∂tchen. Es werden 47 Br√∂tchen verkauft. Wie viele Br√∂tchen sind noch da?", operation: "92 - 47" },
                { text: "Im Regal stehen 66 B√ºcher. Die Klasse leiht sich 29 B√ºcher aus. Wie viele B√ºcher stehen noch im Regal?", operation: "66 - 29" },
                { text: "Paul hat 41 Sammelkarten. Er tauscht 15 Karten mit seinem Freund. Wie viele Karten beh√§lt Paul?", operation: "41 - 15" },
                { text: "Im Aquarium schwimmen 58 Fische. Der Besitzer verkauft 22 Fische. Wie viele Fische bleiben im Aquarium?", operation: "58 - 22" }
            ],
            multiplikation: [
                { text: "Eine Packung hat 6 Eier. Tim kauft 4 Packungen. Wie viele Eier kauft Tim insgesamt?", operation: "6 √ó 4" },
                { text: "Ein Kino hat 8 Reihen. In jeder Reihe sind 12 Sitze. Wie viele Sitze hat das Kino?", operation: "8 √ó 12" },
                { text: "Sarah √ºbt jeden Tag 15 Minuten Klavier. Wie viele Minuten √ºbt sie in 7 Tagen?", operation: "15 √ó 7" },
                { text: "Ein Heft kostet 3 Euro. Die Klasse kauft 9 Hefte. Wie viel kosten alle Hefte zusammen?", operation: "3 √ó 9" },
                { text: "In einem Karton sind 5 Flaschen. Der H√§ndler hat 8 Kartons. Wie viele Flaschen sind das insgesamt?", operation: "5 √ó 8" },
                { text: "Ein Fahrrad hat 2 R√§der. Im Fahrradladen stehen 11 Fahrr√§der. Wie viele R√§der sind das zusammen?", operation: "2 √ó 11" },
                { text: "Marie spart jede Woche 4 Euro. Wie viel Geld hat sie nach 13 Wochen gespart?", operation: "4 √ó 13" },
                { text: "Ein Auto hat 4 Reifen. Auf dem Parkplatz stehen 16 Autos. Wie viele Reifen gibt es insgesamt?", operation: "4 √ó 16" },
                { text: "In einer Box sind 7 Stifte. Tom kauft 6 Boxen. Wie viele Stifte hat er gekauft?", operation: "7 √ó 6" },
                { text: "Ein Blumenstrau√ü hat 9 Blumen. Die Floristin macht 5 Str√§u√üe. Wie viele Blumen braucht sie?", operation: "9 √ó 5" },
                { text: "Ein Tisch hat 6 St√ºhle. Im Restaurant stehen 14 Tische. Wie viele St√ºhle gibt es insgesamt?", operation: "6 √ó 14" },
                { text: "Eine Spinne hat 8 Beine. Im Terrarium sind 3 Spinnen. Wie viele Beine sind das zusammen?", operation: "8 √ó 3" },
                { text: "Ein Buch hat 25 Seiten. Lisa liest 4 solcher B√ºcher. Wie viele Seiten liest sie insgesamt?", operation: "25 √ó 4" },
                { text: "In einer T√ºte sind 12 Gummib√§rchen. Max kauft 7 T√ºten. Wie viele Gummib√§rchen hat er?", operation: "12 √ó 7" },
                { text: "Ein Monat hat 30 Tage. Wie viele Tage haben 3 Monate zusammen?", operation: "30 √ó 3" }
            ],
            division: [
                { text: "24 Sch√ºler sollen in Gruppen aufgeteilt werden. Jede Gruppe hat 6 Sch√ºler. Wie viele Gruppen gibt es?", operation: "24 √∑ 6" },
                { text: "Eine Pizza wird in 8 gleiche St√ºcke geschnitten. 4 Freunde teilen sie gerecht. Wie viele St√ºcke bekommt jeder?", operation: "8 √∑ 4" },
                { text: "Anna hat 36 Murmeln. Sie will sie gleichm√§√üig in 4 T√ºten verteilen. Wie viele Murmeln kommen in jede T√ºte?", operation: "36 √∑ 4" },
                { text: "48 Kekse werden gleichm√§√üig auf 6 Teller verteilt. Wie viele Kekse liegen auf jedem Teller?", operation: "48 √∑ 6" },
                { text: "30 Bonbons sollen an 5 Kinder verteilt werden. Wie viele Bonbons bekommt jedes Kind?", operation: "30 √∑ 5" },
                { text: "Der Lehrer hat 28 B√ºcher. Er verteilt sie gleichm√§√üig an 7 Sch√ºler. Wie viele B√ºcher bekommt jeder?", operation: "28 √∑ 7" },
                { text: "45 √Ñpfel werden in T√ºten zu je 9 √Ñpfeln verpackt. Wie viele T√ºten werden ben√∂tigt?", operation: "45 √∑ 9" },
                { text: "Ein Parkplatz hat 32 Pl√§tze in 8 gleich gro√üen Reihen. Wie viele Pl√§tze hat jede Reihe?", operation: "32 √∑ 8" },
                { text: "54 Stifte werden gleichm√§√üig in 6 Etuis verteilt. Wie viele Stifte kommen in jedes Etui?", operation: "54 √∑ 6" },
                { text: "Eine Klasse mit 27 Sch√ºlern macht 3 gleich gro√üe Teams. Wie viele Sch√ºler sind in jedem Team?", operation: "27 √∑ 3" },
                { text: "40 Euro werden unter 5 Freunden gleichm√§√üig aufgeteilt. Wie viel bekommt jeder?", operation: "40 √∑ 5" },
                { text: "72 Karten werden gleichm√§√üig an 8 Spieler verteilt. Wie viele Karten bekommt jeder Spieler?", operation: "72 √∑ 8" },
                { text: "Ein B√§cker hat 63 Br√∂tchen. Er packt sie in T√ºten zu je 7 Br√∂tchen. Wie viele T√ºten braucht er?", operation: "63 √∑ 7" },
                { text: "56 Sch√ºler fahren mit Bussen. In jeden Bus passen 8 Sch√ºler. Wie viele Busse werden gebraucht?", operation: "56 √∑ 8" },
                { text: "Ein G√§rtner hat 42 Blumen. Er pflanzt sie in 6 gleich gro√üe Beete. Wie viele Blumen kommen in jedes Beet?", operation: "42 √∑ 6" }
            ]
        };

        // Erweiterte Text-Aufgaben Datenbank (50+ Aufgaben)
        const textAufgaben = [
            {
                text: "Die Bienen sind wichtige Helfer in der Natur. Sie fliegen von Bl√ºte zu Bl√ºte und sammeln Nektar. Dabei tragen sie Pollen von einer Pflanze zur anderen. So helfen Bienen den Pflanzen bei der Vermehrung. Ohne Bienen g√§be es weniger Obst und Gem√ºse. Viele Bauern stellen deshalb Bienenst√∂cke in ihre Felder.",
                fragen: [
                    "Was ist die wichtigste Aufgabe der Bienen in der Natur?",
                    "Was sammeln die Bienen von den Bl√ºten?",
                    "Was w√ºrde passieren, wenn es in deiner Stadt keine Bienen mehr g√§be? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Das Fahrrad wurde vor etwa 200 Jahren erfunden. Das erste Fahrrad hatte noch keine Pedale. Man musste sich mit den F√º√üen vom Boden absto√üen. Sp√§ter kamen Pedale und eine Kette dazu. Heute gibt es sogar Fahrr√§der mit Elektromotor. Sie hei√üen E-Bikes.",
                fragen: [
                    "Worum geht es in diesem Text haupts√§chlich?",
                    "Wie bewegte man das erste Fahrrad vorw√§rts?",
                    "Welche Vorteile hat ein E-Bike f√ºr √§ltere Menschen? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Plastik im Meer ist ein gro√ües Problem. Viele Tiere verwechseln Plastik mit Nahrung. Schildkr√∂ten halten Plastikt√ºten f√ºr Quallen. Fische fressen kleine Plastikteile. Das macht die Tiere krank. Menschen k√∂nnen helfen, indem sie weniger Plastik benutzen.",
                fragen: [
                    "Was ist das Hauptproblem, das der Text beschreibt?",
                    "Wof√ºr halten Schildkr√∂ten die Plastikt√ºten?",
                    "Was k√∂nntest du in deinem Alltag tun, um weniger Plastik zu verwenden? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Der Mond ist der einzige nat√ºrliche Begleiter der Erde. Er ist viel kleiner als die Erde. Der Mond hat kein eigenes Licht. Er leuchtet nur, weil die Sonne ihn anstrahlt. Je nachdem, wie Sonne, Erde und Mond zueinander stehen, sehen wir verschiedene Mondphasen.",
                fragen: [
                    "Was ist die wichtigste Information √ºber den Mond?",
                    "Warum leuchtet der Mond am Nachthimmel?",
                    "Warum sieht der Mond manchmal wie eine Sichel aus? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "V√∂gel ziehen im Herbst in den S√ºden. Dort ist es w√§rmer und sie finden mehr Nahrung. Diese V√∂gel nennt man Zugv√∂gel. St√∂rche, Schwalben und Kraniche sind bekannte Zugv√∂gel. Sie fliegen tausende Kilometer weit. Im Fr√ºhling kommen sie wieder zur√ºck.",
                fragen: [
                    "Was machen Zugv√∂gel im Herbst?",
                    "Welche drei Zugv√∂gel werden im Text genannt?",
                    "Wie k√∂nnten wir V√∂geln helfen, die im Winter hier bleiben? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Smartphones sind kleine Computer. Sie passen in jede Hosentasche. Mit ihnen kann man telefonieren, Nachrichten schreiben und im Internet surfen. Die meisten Menschen haben heute ein Smartphone. Kinder bekommen oft ihr erstes Handy mit 10 Jahren.",
                fragen: [
                    "Was ist die Hauptaussage √ºber Smartphones?",
                    "Mit welchem Alter bekommen Kinder oft ihr erstes Handy?",
                    "Welche Nachteile k√∂nnte es haben, wenn man zu viel Zeit am Smartphone verbringt? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Recycling bedeutet, aus alten Sachen neue zu machen. Papier, Glas und Metall kann man gut recyceln. Aus altem Papier wird neues Papier. Die verschiedenen M√ºllsorten werden getrennt gesammelt. In Deutschland gibt es daf√ºr verschiedene Tonnen.",
                fragen: [
                    "Was bedeutet Recycling?",
                    "Welche drei Materialien kann man gut recyceln?",
                    "Warum ist es wichtig, dass alle Menschen beim M√ºlltrennen mitmachen? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Katzen sind beliebte Haustiere. Sie schlafen bis zu 16 Stunden am Tag. Katzen putzen sich sehr oft mit ihrer Zunge. Ihre Zunge ist rau wie Schmirgelpapier. Katzen k√∂nnen sehr gut im Dunkeln sehen. Sie jagen gerne M√§use und V√∂gel.",
                fragen: [
                    "Was ist das Hauptthema dieses Textes?",
                    "Wie viele Stunden schlafen Katzen am Tag?",
                    "Warum sollten Katzenbesitzer ihre Katze mit einem Gl√∂ckchen ausstatten? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "B√§ume produzieren Sauerstoff. Sie nehmen Kohlendioxid aus der Luft auf. Ein gro√üer Baum kann f√ºr zehn Menschen genug Sauerstoff produzieren. B√§ume spenden auch Schatten und sind Lebensraum f√ºr viele Tiere. In St√§dten helfen B√§ume, die Luft zu reinigen.",
                fragen: [
                    "Was ist die wichtigste Funktion von B√§umen?",
                    "F√ºr wie viele Menschen kann ein gro√üer Baum Sauerstoff produzieren?",
                    "Warum sollten in St√§dten mehr B√§ume gepflanzt werden? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Wasser kann drei Formen haben. Als Eis ist es fest. Als Wasser ist es fl√ºssig. Als Dampf ist es gasf√∂rmig. Wasser gefriert bei null Grad. Es kocht bei hundert Grad. Der Wasserkreislauf sorgt daf√ºr, dass es immer wieder regnet.",
                fragen: [
                    "Welche drei Formen kann Wasser haben?",
                    "Bei welcher Temperatur gefriert Wasser?",
                    "Was w√ºrde passieren, wenn es keinen Wasserkreislauf g√§be? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Hunde stammen vom Wolf ab. Sie leben schon seit vielen tausend Jahren bei Menschen. Hunde haben einen sehr guten Geruchssinn. Sie k√∂nnen tausendmal besser riechen als Menschen. Deshalb werden Hunde auch als Sp√ºrhunde eingesetzt. Es gibt √ºber 300 verschiedene Hunderassen.",
                fragen: [
                    "Von welchem Tier stammen Hunde ab?",
                    "Wie viel besser k√∂nnen Hunde riechen als Menschen?",
                    "Wobei k√∂nnten Sp√ºrhunde Menschen helfen? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Die Sonne ist ein Stern. Sie ist sehr hei√ü und sehr weit weg. Das Licht der Sonne braucht acht Minuten bis zur Erde. Ohne die Sonne w√§re es auf der Erde dunkel und kalt. Pflanzen brauchen Sonnenlicht zum Wachsen. Die Sonne geht im Osten auf.",
                fragen: [
                    "Was ist die Sonne?",
                    "Wie lange braucht das Sonnenlicht bis zur Erde?",
                    "Was w√ºrde mit den Tieren passieren, wenn es keine Sonne g√§be? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Vulkane sind √ñffnungen in der Erdkruste. Durch sie kann hei√ües Gestein aus dem Erdinneren nach oben kommen. Dieses hei√üe Gestein nennt man Lava. Wenn Lava erkaltet, wird sie zu festem Gestein. Viele Inseln sind durch Vulkane entstanden. In Deutschland gibt es auch Vulkane.",
                fragen: [
                    "Was sind Vulkane?",
                    "Wie nennt man das hei√üe Gestein aus einem Vulkan?",
                    "Warum leben Menschen in der N√§he von Vulkanen, obwohl es gef√§hrlich sein kann? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Flederm√§use sind die einzigen S√§ugetiere, die fliegen k√∂nnen. Sie schlafen tags√ºber kopf√ºber. Nachts gehen sie auf Jagd. Flederm√§use orientieren sich mit Ultraschall. Sie sto√üen hohe T√∂ne aus und h√∂ren das Echo. So finden sie auch in v√∂lliger Dunkelheit ihre Beute.",
                fragen: [
                    "Was macht Flederm√§use besonders unter den S√§ugetieren?",
                    "Wie orientieren sich Flederm√§use in der Dunkelheit?",
                    "Welche Technik haben Menschen von Flederm√§usen abgeschaut? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Schmetterlinge durchlaufen eine Verwandlung. Aus dem Ei schl√ºpft eine Raupe. Die Raupe frisst viel und w√§chst schnell. Dann verpuppt sie sich. In der Puppe verwandelt sich die Raupe in einen Schmetterling. Diese Verwandlung dauert mehrere Wochen.",
                fragen: [
                    "Was ist das Hauptthema des Textes?",
                    "Was macht die Raupe, bevor sie sich verpuppt?",
                    "Warum sind Schmetterlinge wichtig f√ºr Blumen? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Dinosaurier lebten vor vielen Millionen Jahren. Es gab pflanzenfressende und fleischfressende Arten. Manche Dinosaurier waren so gro√ü wie H√§user. Andere waren klein wie H√ºhner. Vor 65 Millionen Jahren starben alle Dinosaurier aus. Wissenschaftler finden heute noch ihre Knochen.",
                fragen: [
                    "Wann lebten die Dinosaurier?",
                    "Welche zwei Arten von Dinosauriern gab es?",
                    "Warum interessieren sich Menschen heute noch f√ºr Dinosaurier? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Honig wird von Bienen gemacht. Sie sammeln Nektar von Bl√ºten. Im Bienenstock wandeln sie den Nektar in Honig um. Ein Bienenvolk kann im Jahr bis zu 30 Kilo Honig produzieren. Honig ist sehr lange haltbar. Menschen nutzen Honig schon seit tausenden Jahren.",
                fragen: [
                    "Wer macht den Honig?",
                    "Wie viel Honig kann ein Bienenvolk pro Jahr produzieren?",
                    "Warum ist Honig ges√ºnder als Zucker? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Wale sind S√§ugetiere, die im Meer leben. Sie m√ºssen zum Atmen an die Wasseroberfl√§che kommen. Der Blauwal ist das gr√∂√üte Tier der Welt. Er kann 30 Meter lang werden. Wale verst√§ndigen sich mit Ges√§ngen unter Wasser. Manche Walarten sind vom Aussterben bedroht.",
                fragen: [
                    "Was m√ºssen Wale zum Atmen tun?",
                    "Wie lang kann ein Blauwal werden?",
                    "Was k√∂nnen Menschen tun, um Wale zu sch√ºtzen? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Gewitter entstehen bei warmem Wetter. Warme Luft steigt nach oben und bildet Gewitterwolken. In den Wolken entsteht elektrische Spannung. Diese entl√§dt sich als Blitz. Der Donner ist das Ger√§usch des Blitzes. Man sollte bei Gewitter nicht unter B√§umen stehen.",
                fragen: [
                    "Bei welchem Wetter entstehen Gewitter?",
                    "Was ist der Donner?",
                    "Wo ist man bei einem Gewitter am sichersten? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Schnee besteht aus gefrorenem Wasser. Jede Schneeflocke ist einzigartig. Schneeflocken haben immer sechs Ecken. Schnee reflektiert das Sonnenlicht, deshalb ist er wei√ü. In den Bergen liegt oft das ganze Jahr Schnee. Schnee isoliert und sch√ºtzt Pflanzen vor K√§lte.",
                fragen: [
                    "Woraus besteht Schnee?",
                    "Wie viele Ecken hat eine Schneeflocke?",
                    "Warum freuen sich Kinder √ºber Schnee? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Computer bestehen aus Hardware und Software. Hardware sind alle Teile, die man anfassen kann. Software sind die Programme. Der Prozessor ist das Gehirn des Computers. Computer werden immer kleiner und schneller. Heute hat fast jeder Mensch einen Computer.",
                fragen: [
                    "Aus welchen zwei Hauptteilen besteht ein Computer?",
                    "Was ist der Prozessor?",
                    "Welche Nachteile k√∂nnte es haben, wenn Computer alles f√ºr uns erledigen? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Pferde wurden fr√ºher als Transportmittel genutzt. Sie k√∂nnen bis zu 60 Kilometer pro Stunde schnell laufen. Pferde sind Pflanzenfresser. Sie fressen haupts√§chlich Gras und Heu. Ein Pferd kann bis zu 30 Jahre alt werden. Heute werden Pferde meist f√ºr Sport und Freizeit gehalten.",
                fragen: [
                    "Wof√ºr wurden Pferde fr√ºher genutzt?",
                    "Was fressen Pferde haupts√§chlich?",
                    "Warum ist Reiten gut f√ºr Menschen? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Pilze sind weder Pflanzen noch Tiere. Sie bilden ein eigenes Reich. Der sichtbare Pilz ist nur ein kleiner Teil. Der gr√∂√üte Teil w√§chst als Geflecht unter der Erde. Manche Pilze sind essbar, andere sind giftig. Pilze zersetzen totes Material im Wald.",
                fragen: [
                    "Sind Pilze Pflanzen oder Tiere?",
                    "Wo w√§chst der gr√∂√üte Teil des Pilzes?",
                    "Warum sollte man nur Pilze sammeln, die man genau kennt? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Wind entsteht durch Temperaturunterschiede. Warme Luft steigt nach oben, kalte Luft str√∂mt nach. So entsteht Wind. Wind kann Energie erzeugen. Windr√§der wandeln Wind in Strom um. An der K√ºste weht meist mehr Wind als im Landesinneren.",
                fragen: [
                    "Wie entsteht Wind?",
                    "Was machen Windr√§der mit dem Wind?",
                    "Warum ist Windenergie gut f√ºr die Umwelt? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Fische leben im Wasser und atmen mit Kiemen. Sie nehmen Sauerstoff aus dem Wasser auf. Die meisten Fische haben Schuppen und Flossen. Fische legen Eier, die man Laich nennt. Es gibt S√º√üwasserfische und Salzwasserfische. Manche Fische leben in Schw√§rmen.",
                fragen: [
                    "Womit atmen Fische?",
                    "Wie nennt man Fischeier?",
                    "Warum schwimmen manche Fische in Schw√§rmen? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Ameisen leben in gro√üen Staaten zusammen. Jede Ameise hat eine bestimmte Aufgabe. Die K√∂nigin legt Eier. Arbeiterinnen sammeln Nahrung und bauen das Nest. Ameisen k√∂nnen das Zehnfache ihres Gewichts tragen. Sie verst√§ndigen sich mit Duftstoffen.",
                fragen: [
                    "Wie leben Ameisen zusammen?",
                    "Wie viel k√∂nnen Ameisen tragen?",
                    "Was k√∂nnen Menschen von der Organisation der Ameisen lernen? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "B√ºcher gibt es schon seit vielen hundert Jahren. Fr√ºher wurden sie von Hand geschrieben. Heute werden sie gedruckt. Es gibt Sachb√ºcher und Geschichtenb√ºcher. In Bibliotheken kann man B√ºcher ausleihen. Lesen macht schlau und erweitert den Wortschatz.",
                fragen: [
                    "Wie wurden B√ºcher fr√ºher hergestellt?",
                    "Wo kann man B√ºcher ausleihen?",
                    "Warum ist es wichtig, dass Kinder viel lesen? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Der Regenwald ist ein wichtiger Lebensraum. Dort leben mehr Tier- und Pflanzenarten als irgendwo sonst. Regenw√§lder produzieren viel Sauerstoff. Man nennt sie die gr√ºne Lunge der Erde. Leider werden jeden Tag gro√üe Fl√§chen abgeholzt. Das schadet dem Klima.",
                fragen: [
                    "Was ist das Besondere am Regenwald?",
                    "Wie nennt man den Regenwald noch?",
                    "Was k√∂nnen wir tun, um den Regenwald zu sch√ºtzen? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Musik besteht aus T√∂nen und Rhythmus. Menschen machen schon seit Urzeiten Musik. Es gibt viele verschiedene Instrumente. Manche werden gezupft, andere geblasen oder geschlagen. Musik kann Gef√ºhle ausdr√ºcken. Viele Menschen h√∂ren t√§glich Musik.",
                fragen: [
                    "Woraus besteht Musik?",
                    "Was kann Musik ausdr√ºcken?",
                    "Warum macht Musik Menschen gl√ºcklich? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Obst enth√§lt viele Vitamine. Vitamine sind wichtig f√ºr unseren K√∂rper. √Ñpfel, Bananen und Orangen sind beliebte Obstsorten. Obst w√§chst an B√§umen oder Str√§uchern. Man sollte t√§glich Obst essen. Regional und saisonal ist am besten.",
                fragen: [
                    "Was enth√§lt Obst?",
                    "Wo w√§chst Obst?",
                    "Warum ist es besser, Obst aus der Region zu kaufen? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Z√ºge fahren auf Schienen. Sie k√∂nnen viele Menschen gleichzeitig transportieren. Der erste Zug fuhr vor etwa 200 Jahren. Moderne Z√ºge fahren mit Strom. Hochgeschwindigkeitsz√ºge k√∂nnen √ºber 300 Stundenkilometer schnell fahren. Zugfahren ist umweltfreundlich.",
                fragen: [
                    "Worauf fahren Z√ºge?",
                    "Womit fahren moderne Z√ºge?",
                    "Warum sollten mehr Menschen mit dem Zug statt mit dem Auto fahren? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Sterne sind riesige Gaskugeln im Weltall. Sie leuchten, weil in ihrem Inneren Energie entsteht. Unsere Sonne ist auch ein Stern. Nachts k√∂nnen wir viele Sterne sehen. In der Stadt sieht man weniger Sterne als auf dem Land. Das liegt an der Lichtverschmutzung.",
                fragen: [
                    "Was sind Sterne?",
                    "Warum sieht man in der Stadt weniger Sterne?",
                    "Warum faszinieren Sterne die Menschen seit Jahrtausenden? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Milch kommt von K√ºhen, Ziegen oder Schafen. Sie enth√§lt Kalzium, das gut f√ºr die Knochen ist. Aus Milch macht man K√§se, Joghurt und Butter. K√ºhe geben t√§glich bis zu 30 Liter Milch. Manche Menschen vertragen keine Milch. Das nennt man Laktoseintoleranz.",
                fragen: [
                    "Von welchen Tieren kommt Milch?",
                    "Was ist gut f√ºr die Knochen?",
                    "Welche Alternativen gibt es f√ºr Menschen, die keine Milch vertragen? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Sport ist gesund f√ºr K√∂rper und Geist. Bewegung st√§rkt die Muskeln und das Herz. Es gibt Einzelsportarten und Mannschaftssportarten. Fu√üball ist in Deutschland sehr beliebt. Sport macht mehr Spa√ü in der Gruppe. Kinder sollten t√§glich eine Stunde Sport treiben.",
                fragen: [
                    "Was st√§rkt die Bewegung?",
                    "Wie lange sollten Kinder t√§glich Sport treiben?",
                    "Was lernt man beim Mannschaftssport au√üer der Sportart selbst? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Geld ist ein Tauschmittel. Fr√ºher tauschten Menschen Waren direkt. Heute bezahlen wir mit M√ºnzen und Scheinen. Es gibt auch digitales Geld auf Konten. Der Euro ist unsere W√§hrung. In anderen L√§ndern gibt es andere W√§hrungen.",
                fragen: [
                    "Was ist Geld?",
                    "Wie hei√üt unsere W√§hrung?",
                    "Warum ist es wichtig, den Umgang mit Geld zu lernen? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Feuer entsteht, wenn etwas brennt. Daf√ºr braucht es drei Dinge: Brennstoff, Sauerstoff und Hitze. Feuer kann n√ºtzlich sein zum Heizen und Kochen. Es kann aber auch gef√§hrlich werden. Bei einem Brand muss man sofort die Feuerwehr rufen. Die Nummer ist 112.",
                fragen: [
                    "Was braucht Feuer zum Brennen?",
                    "Welche Nummer hat die Feuerwehr?",
                    "Warum war die Entdeckung des Feuers so wichtig f√ºr die Menschen? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Magnete ziehen bestimmte Metalle an. Jeder Magnet hat einen Nord- und einen S√ºdpol. Gleiche Pole sto√üen sich ab. Unterschiedliche Pole ziehen sich an. Die Erde ist ein gro√üer Magnet. Deshalb funktioniert der Kompass.",
                fragen: [
                    "Was ziehen Magnete an?",
                    "Was passiert bei gleichen Polen?",
                    "Wo werden Magnete im Alltag verwendet? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Br√ºcken verbinden zwei Ufer oder T√§ler. Es gibt verschiedene Arten von Br√ºcken. H√§ngebr√ºcken, Bogenbr√ºcken und Balkenbr√ºcken sind die h√§ufigsten. Die l√§ngste Br√ºcke der Welt ist √ºber 160 Kilometer lang. Br√ºcken m√ºssen sehr stabil gebaut werden.",
                fragen: [
                    "Was verbinden Br√ºcken?",
                    "Welche drei Br√ºckenarten werden genannt?",
                    "Was w√ºrde passieren, wenn es keine Br√ºcken g√§be? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Farben entstehen durch Licht. Wei√ües Licht besteht aus allen Farben. Ein Regenbogen zeigt alle Farben des Lichts. Die Grundfarben sind Rot, Gelb und Blau. Aus ihnen kann man alle anderen Farben mischen. Farben beeinflussen unsere Stimmung.",
                fragen: [
                    "Woraus besteht wei√ües Licht?",
                    "Welche sind die drei Grundfarben?",
                    "Warum werden Krankenh√§user oft in hellen Farben gestrichen? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Energie kann verschiedene Formen haben. Es gibt Bewegungsenergie, W√§rmeenergie und elektrische Energie. Energie kann nicht verloren gehen, nur umgewandelt werden. Die Sonne ist unsere wichtigste Energiequelle. Wir sollten sparsam mit Energie umgehen.",
                fragen: [
                    "Welche Energieformen werden im Text genannt?",
                    "Was ist unsere wichtigste Energiequelle?",
                    "Wie kannst du zu Hause Energie sparen? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Bakterien sind winzig kleine Lebewesen. Man kann sie nur mit dem Mikroskop sehen. Es gibt n√ºtzliche und sch√§dliche Bakterien. N√ºtzliche Bakterien helfen bei der Verdauung. Sch√§dliche Bakterien k√∂nnen Krankheiten verursachen. H√§ndewaschen sch√ºtzt vor vielen Bakterien.",
                fragen: [
                    "Womit kann man Bakterien sehen?",
                    "Wobei helfen n√ºtzliche Bakterien?",
                    "Wann ist H√§ndewaschen besonders wichtig? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Wolken bestehen aus winzigen Wassertr√∂pfchen. Sie entstehen, wenn Wasser verdunstet und aufsteigt. In der H√∂he k√ºhlt der Wasserdampf ab und wird zu Tr√∂pfchen. Es gibt verschiedene Wolkenarten. Dunkle Wolken bringen meist Regen. Wei√üe Wolken bedeuten sch√∂nes Wetter.",
                fragen: [
                    "Woraus bestehen Wolken?",
                    "Was bedeuten dunkle Wolken meist?",
                    "Warum regnet es in Bergen √∂fter als im Flachland? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Eis schmilzt bei null Grad Celsius. Salz l√§sst Eis schneller schmelzen. Deshalb streut man im Winter Salz auf die Stra√üen. Eis ist leichter als Wasser. Darum schwimmt es oben. Das ist wichtig f√ºr Fische im Winter.",
                fragen: [
                    "Bei welcher Temperatur schmilzt Eis?",
                    "Warum streut man Salz auf vereiste Stra√üen?",
                    "Was w√ºrde mit Fischen im See passieren, wenn Eis schwerer als Wasser w√§re? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Pflanzen brauchen Licht, Wasser und N√§hrstoffe zum Wachsen. Mit ihren Wurzeln nehmen sie Wasser aus dem Boden auf. Die Bl√§tter fangen Sonnenlicht ein. Dabei produzieren Pflanzen Sauerstoff. Ohne Pflanzen k√∂nnten Menschen und Tiere nicht leben.",
                fragen: [
                    "Was brauchen Pflanzen zum Wachsen?",
                    "Was produzieren Pflanzen?",
                    "Warum sollte jeder Mensch eine Pflanze haben? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Erdbeben entstehen, wenn sich Erdplatten bewegen. Die Erde besteht aus verschiedenen Platten. Diese bewegen sich sehr langsam. Manchmal verhaken sie sich und l√∂sen sich ruckartig. Das sp√ºren wir als Erdbeben. In manchen L√§ndern gibt es oft Erdbeben.",
                fragen: [
                    "Wie entstehen Erdbeben?",
                    "Woraus besteht die Erde?",
                    "Warum bauen Menschen in Erdbebengebieten besondere H√§user? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Zeit messen wir mit Uhren. Ein Tag hat 24 Stunden. Eine Stunde hat 60 Minuten. Eine Minute hat 60 Sekunden. Fr√ºher orientierten sich Menschen an der Sonne. Heute haben wir genaue Atomuhren.",
                fragen: [
                    "Womit messen wir Zeit?",
                    "Wie viele Minuten hat eine Stunde?",
                    "Warum ist P√ºnktlichkeit in unserer Gesellschaft wichtig? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Flugzeuge k√∂nnen fliegen, weil ihre Fl√ºgel besonders geformt sind. Die Luft str√∂mt oben schneller als unten. Dadurch entsteht Auftrieb. Gro√üe Flugzeuge k√∂nnen √ºber 500 Menschen transportieren. Fliegen ist die schnellste Art zu reisen. Ein Flug nach Amerika dauert etwa acht Stunden.",
                fragen: [
                    "Warum k√∂nnen Flugzeuge fliegen?",
                    "Wie viele Menschen passen in gro√üe Flugzeuge?",
                    "Welche Nachteile hat das Fliegen f√ºr die Umwelt? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Papier wird aus Holz hergestellt. B√§ume werden gef√§llt und zu Fasern verarbeitet. Diese Fasern werden zu Papier gepresst. Man kann auch Altpapier recyceln. Das schont die W√§lder. Jeder Deutsche verbraucht im Jahr etwa 250 Kilo Papier.",
                fragen: [
                    "Woraus wird Papier hergestellt?",
                    "Wie viel Papier verbraucht jeder Deutsche im Jahr?",
                    "Wie kannst du im Alltag Papier sparen? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Schlaf ist wichtig f√ºr unseren K√∂rper. Kinder brauchen mehr Schlaf als Erwachsene. Im Schlaf erholt sich der K√∂rper. Das Gehirn verarbeitet die Erlebnisse des Tages. Zu wenig Schlaf macht krank. Jugendliche sollten etwa neun Stunden schlafen.",
                fragen: [
                    "Warum ist Schlaf wichtig?",
                    "Wie viele Stunden sollten Jugendliche schlafen?",
                    "Warum k√∂nnen viele Menschen abends schlecht einschlafen? (Denke √ºber den Text hinaus)"
                ]
            },
            {
                text: "Z√§hne bestehen aus dem h√§rtesten Material im K√∂rper. Kinder haben 20 Milchz√§hne. Erwachsene haben 32 bleibende Z√§hne. Z√§hne m√ºssen zweimal t√§glich geputzt werden. Zucker schadet den Z√§hnen. Beim Zahnarzt sollte man zweimal im Jahr zur Kontrolle.",
                fragen: [
                    "Wie viele Milchz√§hne haben Kinder?",
                    "Wie oft sollte man die Z√§hne putzen?",
                    "Warum haben viele Kinder Angst vor dem Zahnarzt? (Denke √ºber den Text hinaus)"
                ]
            }
        ];

        let aktuelleAufgabe = null;
        let aktuellerIndex = null;
        let aufgabenTyp = '';

        // Hilfsfunktion f√ºr Wiederholungsschutz
        function holeZufaelligeAufgabe(aufgabenListe, typ) {
            let verfuegbareIndizes = [];
            for (let i = 0; i < aufgabenListe.length; i++) {
                if (!letzteAufgabenIndizes[typ].includes(i)) {
                    verfuegbareIndizes.push(i);
                }
            }
            
            // Falls alle Aufgaben k√ºrzlich verwendet wurden, Liste zur√ºcksetzen
            if (verfuegbareIndizes.length === 0) {
                letzteAufgabenIndizes[typ] = [];
                verfuegbareIndizes = Array.from({length: aufgabenListe.length}, (_, i) => i);
            }
            
            // Zuf√§lligen Index aus verf√ºgbaren w√§hlen
            const zufallsIndex = verfuegbareIndizes[Math.floor(Math.random() * verfuegbareIndizes.length)];
            
            // Index zur Liste der zuletzt verwendeten hinzuf√ºgen
            letzteAufgabenIndizes[typ].push(zufallsIndex);
            
            // Liste auf maximale L√§nge begrenzen
            if (letzteAufgabenIndizes[typ].length > WIEDERHOLUNGSSCHUTZ_ANZAHL) {
                letzteAufgabenIndizes[typ].shift();
            }
            
            return aufgabenListe[zufallsIndex];
        }

        function generiereZufaelligeAufgabe() {
            if (Math.random() < 0.5) {
                generiereMatheAufgabe();
            } else {
                generiereTextAufgabe();
            }
        }

        function generiereMatheAufgabe() {
            // Zuf√§llige Operation w√§hlen
            const operationen = ['addition', 'subtraktion', 'multiplikation', 'division'];
            const zufaelligeOperation = operationen[Math.floor(Math.random() * operationen.length)];
            
            // Alle Mathe-Aufgaben in eine Liste zusammenf√ºhren f√ºr Wiederholungsschutz
            const alleMatheAufgaben = [];
            for (let op in matheAufgaben) {
                alleMatheAufgaben.push(...matheAufgaben[op]);
            }
            
            // Zuf√§llige Aufgabe mit Wiederholungsschutz
            const zufaelligeAufgabe = holeZufaelligeAufgabe(matheAufgaben[zufaelligeOperation], 'mathe');
            
            aktuelleAufgabe = zufaelligeAufgabe;
            aufgabenTyp = 'Mathematik-Textaufgabe';
            
            // UI aktualisieren
            document.getElementById('startMeldung').classList.add('hidden');
            document.getElementById('aufgabenBereich').classList.remove('hidden');
            
            // Aufgabentyp anzeigen
            const typElement = document.getElementById('aufgabenTyp');
            typElement.className = 'mb-4 p-3 rounded-lg text-center font-semibold bg-blue-100 text-blue-800';
            typElement.innerHTML = '‚ûï Mathematik-Textaufgabe';
            
            // Aufgabentext anzeigen
            document.getElementById('aufgabenText').innerHTML = `
                <h3 class="font-bold text-xl mb-3 text-gray-800">Textaufgabe:</h3>
                <p class="text-gray-700">${zufaelligeAufgabe.text}</p>
            `;
            
            // Antwortfelder erstellen
            document.getElementById('antwortBereich').innerHTML = `
                <div class="bg-blue-50 p-4 rounded-lg">
                    <label class="block text-gray-700 font-semibold mb-2">
                        1. Welche Rechnung musst du durchf√ºhren?
                    </label>
                    <input type="text" id="antwort1" class="w-full p-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none text-lg"
                           placeholder="Schreibe die Rechnung auf (z.B. 5 + 3)">
                </div>
                <div class="bg-blue-50 p-4 rounded-lg">
                    <label class="block text-gray-700 font-semibold mb-2">
                        2. L√∂sung:
                    </label>
                    <input type="text" id="antwort2" class="w-full p-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none text-lg"
                           placeholder="Schreibe das Ergebnis">
                </div>
            `;
        }

        function generiereTextAufgabe() {
            // Zuf√§llige Textaufgabe mit Wiederholungsschutz
            const zufaelligeAufgabe = holeZufaelligeAufgabe(textAufgaben, 'text');
            
            aktuelleAufgabe = zufaelligeAufgabe;
            aufgabenTyp = 'Textverst√§ndnis';
            
            // UI aktualisieren
            document.getElementById('startMeldung').classList.add('hidden');
            document.getElementById('aufgabenBereich').classList.remove('hidden');
            
            // Aufgabentyp anzeigen
            const typElement = document.getElementById('aufgabenTyp');
            typElement.className = 'mb-4 p-3 rounded-lg text-center font-semibold bg-green-100 text-green-800';
            typElement.innerHTML = 'üìñ Textverst√§ndnis-Aufgabe';
            
            // Aufgabentext anzeigen
            document.getElementById('aufgabenText').innerHTML = `
                <h3 class="font-bold text-xl mb-3 text-gray-800">Text:</h3>
                <p class="text-gray-700 leading-relaxed">${zufaelligeAufgabe.text}</p>
            `;
            
            // Antwortfelder f√ºr die drei Fragen erstellen
            let antwortHTML = '';
            zufaelligeAufgabe.fragen.forEach((frage, index) => {
                antwortHTML += `
                    <div class="bg-green-50 p-4 rounded-lg">
                        <label class="block text-gray-700 font-semibold mb-2">
                            Frage ${index + 1}: ${frage}
                        </label>
                        <textarea id="antwort${index + 1}" rows="2" 
                                  class="w-full p-3 border-2 border-gray-300 rounded-lg focus:border-green-500 focus:outline-none text-lg"
                                  placeholder="Schreibe deine Antwort hier..."></textarea>
                    </div>
                `;
            });
            document.getElementById('antwortBereich').innerHTML = antwortHTML;
        }

        function speichereAntworten() {
            if (!aktuelleAufgabe) {
                alert('Bitte generiere zuerst eine Aufgabe!');
                return;
            }
            
            const antworten = [];
            const anzahlFragen = aufgabenTyp === 'Mathematik-Textaufgabe' ? 2 : 3;
            
            for (let i = 1; i <= anzahlFragen; i++) {
                const antwortElement = document.getElementById(`antwort${i}`);
                if (antwortElement) {
                    antworten.push(antwortElement.value);
                }
            }
            
            // Pr√ºfen ob alle Antworten ausgef√ºllt sind
            if (antworten.some(a => a.trim() === '')) {
                alert('Bitte f√ºlle alle Antwortfelder aus!');
                return;
            }
            
            // Speichern im LocalStorage
            const gespeicherteDaten = JSON.parse(localStorage.getItem('lernaufgaben') || '[]');
            const neuerEintrag = {
                datum: new Date().toLocaleString('de-DE'),
                typ: aufgabenTyp,
                aufgabe: aktuelleAufgabe,
                antworten: antworten
            };
            
            gespeicherteDaten.unshift(neuerEintrag); // Am Anfang hinzuf√ºgen
            
            // Maximal 50 Eintr√§ge speichern
            if (gespeicherteDaten.length > 50) {
                gespeicherteDaten.pop();
            }
            
            localStorage.setItem('lernaufgaben', JSON.stringify(gespeicherteDaten));
            
            // Erfolgsmeldung
            alert('‚úÖ Deine Antworten wurden gespeichert!');
            
            // Felder leeren
            for (let i = 1; i <= anzahlFragen; i++) {
                const antwortElement = document.getElementById(`antwort${i}`);
                if (antwortElement) {
                    antwortElement.value = '';
                }
            }
        }

        function zeigeGespeicherteAntworten() {
            const gespeicherteDaten = JSON.parse(localStorage.getItem('lernaufgaben') || '[]');
            
            if (gespeicherteDaten.length === 0) {
                alert('Es sind noch keine Antworten gespeichert.');
                return;
            }
            
            let inhaltHTML = '';
            
            gespeicherteDaten.forEach((eintrag, index) => {
                const farbKlasse = eintrag.typ === 'Mathematik-Textaufgabe' ? 'bg-blue-50' : 'bg-green-50';
                
                inhaltHTML += `
                    <div class="${farbKlasse} p-4 rounded-lg mb-4">
                        <div class="flex justify-between items-start mb-2">
                            <span class="font-semibold text-gray-700">${eintrag.typ}</span>
                            <span class="text-sm text-gray-500">${eintrag.datum}</span>
                        </div>
                        <div class="mt-2 text-gray-700">
                            <p class="font-medium mb-2">Aufgabe:</p>
                            <p class="mb-3 italic">${eintrag.aufgabe.text}</p>
                            <p class="font-medium mb-1">Deine Antworten:</p>
                `;
                
                if (eintrag.typ === 'Mathematik-Textaufgabe') {
                    inhaltHTML += `
                        <p class="ml-4">‚Ä¢ Rechnung: ${eintrag.antworten[0]}</p>
                        <p class="ml-4">‚Ä¢ L√∂sung: ${eintrag.antworten[1]}</p>
                    `;
                } else {
                    eintrag.aufgabe.fragen.forEach((frage, i) => {
                        inhaltHTML += `
                            <p class="ml-4 mb-1">‚Ä¢ ${frage}</p>
                            <p class="ml-8 text-blue-700 mb-2">‚Üí ${eintrag.antworten[i]}</p>
                        `;
                    });
                }
                
                inhaltHTML += `
                        </div>
                        <button onclick="loescheEintrag(${index})" 
                                class="mt-2 text-red-600 hover:text-red-800 text-sm">
                            üóëÔ∏è L√∂schen
                        </button>
                    </div>
                `;
            });
            
            inhaltHTML += `
                <div class="mt-4 text-center">
                    <button onclick="loescheAlleEintraege()" 
                            class="bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600">
                        üóëÔ∏è Alle Eintr√§ge l√∂schen
                    </button>
                </div>
            `;
            
            document.getElementById('gespeicherteAntwortenInhalt').innerHTML = inhaltHTML;
            document.getElementById('gespeicherteAntwortenModal').classList.remove('hidden');
        }

        function loescheEintrag(index) {
            if (confirm('M√∂chtest du diesen Eintrag wirklich l√∂schen?')) {
                const gespeicherteDaten = JSON.parse(localStorage.getItem('lernaufgaben') || '[]');
                gespeicherteDaten.splice(index, 1);
                localStorage.setItem('lernaufgaben', JSON.stringify(gespeicherteDaten));
                zeigeGespeicherteAntworten(); // Ansicht aktualisieren
            }
        }

        function loescheAlleEintraege() {
            if (confirm('M√∂chtest du wirklich ALLE gespeicherten Eintr√§ge l√∂schen?')) {
                localStorage.removeItem('lernaufgaben');
                schliesseModal();
                alert('Alle Eintr√§ge wurden gel√∂scht.');
            }
        }

        function schliesseModal() {
            document.getElementById('gespeicherteAntwortenModal').classList.add('hidden');
        }

        // ESC-Taste zum Schlie√üen des Modals
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                schliesseModal();
            }
        });

        // Info beim Laden anzeigen
        console.log(`üìö Lernaufgaben-Tool geladen!`);
        console.log(`‚ûï ${Object.values(matheAufgaben).flat().length} Mathe-Aufgaben verf√ºgbar`);
        console.log(`üìñ ${textAufgaben.length} Textverst√§ndnis-Aufgaben verf√ºgbar`);
    </script>
</body>
</html>